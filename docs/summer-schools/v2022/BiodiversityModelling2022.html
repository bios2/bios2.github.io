<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dominique Gravel">
<meta name="author" content="Vincent Beauregard">
<meta name="dcterms.date" content="2022-08-22">
<meta name="description" content="  The 2022 edition of the Biodiversity Modelling Summer School was on the theme: Biodiversity changes and data visualization. The course took the form of a workshop during which the students, in collaboration with local organizations involved in biodiversity monitoring, developed a web platform for visualizing biodiversity changes.">

<title>Biodiversity Modelling 2022 – BIOS² Education resources</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-ecb778d5ef56ea6a42975469c354c5e4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: [{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] }],
      
      searchColumns: [],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-listing'] = new List('listing-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../Bios2_reverse.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">BIOS² Education resources</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-intensive-courses" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Intensive courses</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-intensive-courses">    
        <li>
    <a class="dropdown-item" href="../../summer-schools/v2024/BiodiversityModelling2024.html">
 <span class="dropdown-text">Biodiversity Modelling Summer School 2024</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../summer-schools/v2022/BiodiversityModelling2022.html">
 <span class="dropdown-text">Biodiversity Modelling Summer School 2022</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://bios2.github.io/biodiversity_modelling_2021/">
 <span class="dropdown-text">Biodiversity Modelling Summer School 2021</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../summer-schools/v2019/BiodiversityModelling2019.html">
 <span class="dropdown-text">Biodiversity Modelling Summer School 2019</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://bios2.usherbrooke.ca/"> 
<span class="menu-text">About BIOS²</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bios2/bios2.github.io"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/_bios2"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#biodiversity-changes-and-data-visualization" id="toc-biodiversity-changes-and-data-visualization" class="nav-link active" data-scroll-target="#biodiversity-changes-and-data-visualization"><span class="header-section-number">1</span> Biodiversity Changes and Data Visualization</a>
  <ul class="collapse">
  <li><a href="#general-objective" id="toc-general-objective" class="nav-link" data-scroll-target="#general-objective">General objective</a></li>
  <li><a href="#pedagogical-approach" id="toc-pedagogical-approach" class="nav-link" data-scroll-target="#pedagogical-approach">Pedagogical approach</a></li>
  <li><a href="#materials" id="toc-materials" class="nav-link" data-scroll-target="#materials">Materials</a>
  <ul class="collapse">
  <li><a href="#day-1-monday-august-22" id="toc-day-1-monday-august-22" class="nav-link" data-scroll-target="#day-1-monday-august-22">Day 1: Monday, August 22</a></li>
  <li><a href="#day-2-tuesday-august-23" id="toc-day-2-tuesday-august-23" class="nav-link" data-scroll-target="#day-2-tuesday-august-23">Day 2: Tuesday, August 23</a></li>
  <li><a href="#day-3-wednesday-august-24" id="toc-day-3-wednesday-august-24" class="nav-link" data-scroll-target="#day-3-wednesday-august-24">Day 3: Wednesday, August 24</a></li>
  <li><a href="#day-4-thursday-august-25" id="toc-day-4-thursday-august-25" class="nav-link" data-scroll-target="#day-4-thursday-august-25">Day 4: Thursday, August 25</a></li>
  <li><a href="#day-5-friday-august-26" id="toc-day-5-friday-august-26" class="nav-link" data-scroll-target="#day-5-friday-august-26">Day 5: Friday, August 26</a></li>
  </ul></li>
  <li><a href="#more-information" id="toc-more-information" class="nav-link" data-scroll-target="#more-information">More information</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Biodiversity Modelling 2022</h1>
</div>

<div>
  <div class="description">
    <br> The 2022 edition of the Biodiversity Modelling Summer School was on the theme: Biodiversity changes and data visualization. The course took the form of a workshop during which the students, in collaboration with local organizations involved in biodiversity monitoring, developed a web platform for visualizing biodiversity changes.
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Dominique Gravel </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Université de Sherbrooke
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Vincent Beauregard </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Université de Sherbrooke
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 22, 2022</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="biodiversity-changes-and-data-visualization" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Biodiversity Changes and Data Visualization</h1>
<p>The 2022 edition of the Biodiversity Modelling Summer School was presented by Dominique Gravel and Vincent Beauregard (Université de Sherbrooke) as well as several invited experts and partners.</p>
<p>It took place from August 22 to August 26 2022 in the form of a retreat at the Jouvence Resort in Orford in the heart of the Eastern Townships.</p>
<p>The intensive summer school is supported by Université de Sherbrooke and the NSERC-CREATE Training program in computational biodiversity science and services BIOS².</p>
<section id="general-objective" class="level2">
<h2 class="anchored" data-anchor-id="general-objective">General objective</h2>
<p>Massive, complex and sometimes real-time data offer new opportunities for biodiversity monitoring. Data science uses a variety of methods to extract knowledge from multi-dimensional information systems to address a wide range of applications and disciplines. The increasing availability of information on biodiversity and its changes also comes with a challenge of communication and representation, not only to scientists but also to policy makers and the general public. Biodiversity science is no exception and quantitative ecologists are called upon to develop communication techniques and tools to assist decision making. This process, often referred to as business intelligence, relies on a set of skills that range from consulting with partners to the production of interactive applications, through the creation of data models and analysis schemes.</p>
<p>At the end of this course, students will be able to conceptualize and develop a communication strategy based on biodiversity data to meet the needs of a partner.</p>
<p>Upon completion of this course, students will be able to:</p>
<ul>
<li>Formulate an intervention plan based on business intelligence principles</li>
<li>Identify the information needs of a partner</li>
<li>Characterize the profile of data users</li>
<li>Set up a data model specific to the communication strategy</li>
<li>Conceptualize an interactive dashboard in the form of a model</li>
</ul>
</section>
<section id="pedagogical-approach" class="level2">
<h2 class="anchored" data-anchor-id="pedagogical-approach">Pedagogical approach</h2>
<p>The course is based on a strategic communication mandate for a partner organization. Students will conduct a consultation to identify information needs and develop the appropriate data model. Sessions consist of short lectures on theoretical concepts presented by specialists from different disciplines, interspersed with specific exercises designed to practice the elements taught and apply them to their consulting problem. The projects are based on data organized and distributed by Biodiversité Québec.</p>
</section>
<section id="materials" class="level2">
<h2 class="anchored" data-anchor-id="materials">Materials</h2>
<section id="day-1-monday-august-22" class="level3">
<h3 class="anchored" data-anchor-id="day-1-monday-august-22">Day 1: Monday, August 22</h3>
<p>The first day of the course was focused on initiating a mandate with partners.</p>
<p>The session covered:</p>
<ul>
<li>Introduction to the course</li>
<li>Presentation of partners</li>
<li>Consultation workshop</li>
</ul>
<p>Participants prepared their first <strong>deliverable</strong>: Schematization of the consultation mandate.</p>
<p>View the presentation for this session below:</p>
<iframe src="https://widgets.figshare.com/articles/21335004/embed?show_title=0" width="580" height="425" allowfullscreen="" frameborder="0">
</iframe>
</section>
<section id="day-2-tuesday-august-23" class="level3">
<h3 class="anchored" data-anchor-id="day-2-tuesday-august-23">Day 2: Tuesday, August 23</h3>
<p>The second day of the course was focused on business intelligence and design, with guest expert <a href="https://www.usherbrooke.ca/ecole-gestion/personnel/professeurs/simqg/daniel-chamberland-tremblay">Daniel Chamberland-Tremblay</a> from the École de Gestion at Université de Sherbrooke.</p>
<p>The session covered:</p>
<ul>
<li>Business Intelligence Principles</li>
<li>Mike2.0 methodology</li>
<li>Elements of design</li>
<li>Development of persona and user journey</li>
</ul>
<p>Participants prepared a <strong>deliverable</strong>: User characterization grid.</p>
<p>View the presentation for this session below:</p>
<iframe src="https://widgets.figshare.com/articles/21357207/embed?show_title=0" width="580" height="425" allowfullscreen="" frameborder="0">
</iframe>
</section>
<section id="day-3-wednesday-august-24" class="level3">
<h3 class="anchored" data-anchor-id="day-3-wednesday-august-24">Day 3: Wednesday, August 24</h3>
<p>The third day of the course covered data models, biodiversity indicators, and media.</p>
<ul>
<li>Data and information systems architecture</li>
<li>Essential biodiversity variables</li>
<li>Case study: Living Planet Index and Biodiversity Distribution Index</li>
<li>Data journalism and digital storytelling</li>
</ul>
<p>Participants prepared a <strong>deliverable</strong>: Conceptualization of the data and indicators model.</p>
<p>View the presentation for this session below:</p>
<iframe src="https://widgets.figshare.com/articles/21335049/embed?show_title=0" width="580" height="425" allowfullscreen="" frameborder="0">
</iframe>
</section>
<section id="day-4-thursday-august-25" class="level3">
<h3 class="anchored" data-anchor-id="day-4-thursday-august-25">Day 4: Thursday, August 25</h3>
<p>The fourth day focused on interactive dashboards and data visualisation principles with guest expert Thomas Hurtut, a <a href="http://www.professeurs.polymtl.ca/thomas.hurtut/">professor at Polytechnique Montréal</a> and co-founder of <a href="https://kashika.studio/">Kashika studio</a>.</p>
<p>The session covered:</p>
<ul>
<li>Dashboard design</li>
<li>For an effective visualization</li>
<li>Visualization tools and technologies</li>
<li>Model design using Figma</li>
</ul>
<p>Participants prepated a <strong>deliverable</strong>: Interactive dashboard model.</p>
<p>View the presentation “Data visualization design: process and principles” by guest expert Thomas Hurtut <a href="https://bit.ly/dataviz_uds"><strong>here</strong></a>.</p>
</section>
<section id="day-5-friday-august-26" class="level3">
<h3 class="anchored" data-anchor-id="day-5-friday-august-26">Day 5: Friday, August 26</h3>
<p>On the final day, participants completed and presented their projects to the group and to their partners.</p>
<p>The session covered:</p>
<ul>
<li>Figma workshop (continuation and end)</li>
<li>Presentation of the models</li>
<li>Exchanges with the partners</li>
</ul>
<p>There is no presentation for this day.</p>
</section>
</section>
<section id="more-information" class="level2">
<h2 class="anchored" data-anchor-id="more-information">More information</h2>
<p>Visit the course homepage <a href="https://www.usherbrooke.ca/ecoles-de-pointe/en/2022-biodiversity-modelling">here</a> and learn more about the course content and format <a href="https://www.usherbrooke.ca/ecoles-de-pointe/en/home/biology/2022-biodiversity-modelling/content-and-format">here</a>.</p>



</section>
</section>

<div class="quarto-listing quarto-listing-container-default" id="listing-listing">
<div class="listing-actions-group">
</div>
<div class="list quarto-listing-default">

</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/bios2\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>