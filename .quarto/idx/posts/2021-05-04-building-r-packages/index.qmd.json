{"title":"Building R packages","markdown":{"yaml":{"title":"Building R packages","description":"This practical training will cover the basics of modern package development in R with a focus on the following three aspects: (1) how to turn your code into functions, (2) how to write tests and documentation, and (3) how to share your R package on GitHub..\n","author":[{"name":"Andrew MacDonald","affilitation":"Université de Sherbrooke"}],"date":"2021-05-04","image":"altumcode-PNbDkQ2DDgM-unsplash.jpeg","categories":["Technical","EN"],"toc":true,"number-sections":true,"number-depth":1},"headingText":"*Mise en place* : development environment","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = FALSE, message = FALSE)\n```\n\n<iframe src=\"https://giphy.com/embed/HGe4zsOVo7Jvy\" width=\"480\" height=\"270\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen>\n\n</iframe>\n\n<p><a href=\"https://giphy.com/gifs/sesame-street-cookies-cookie-monster-HGe4zsOVo7Jvy\">via GIPHY</a></p>\n\nR packages! they are kind of like cookies:\n\n-   Almost everyone enjoys them\n\n-   delicious when homemade\n\n-   Lots of storebought options available\n\n-   Great skill to have\n\n-   not necessary to sell them!\n\n    <aside>here \"selling\" cookies is a metaphor for taking your package public, i.e. by submitting to CRAN or even simply by releasing it on a public-facing GitHub page.</aside>\n\nBut most of all: cookies are delicious for what they *contain*: chocolate chunks, candy, oats, cocoa. However, all cookies share some fundamental ingredients and nearly identical structure. Flour, saturated with fat and sugar hydrated only with an egg, flavoured with vanilla and salt. The basic formula is invariant and admits only slight deviation -- otherwise, it becomes something other than a cookie.\n\nThis workshop is devoted to the study of cookie dough.\n\n\nWe'll explore a few useful packages in this workshop. The first two in particular are very popular tools for modern-day R package development:\n\n``` r\ninstall.packages(\"devtools\")\ninstall.packages(\"usethis\")\ninstall.packages(\"testthat\")\ninstall.packages(\"assertthat\")\n```\n\nBuilding an R package also requires specific tools for compiling the finished package. Run the following line to make sure you have the development environment:\n\n``` r\ndevtools::has_devel()\n```\n\nIf you do not have the software to build R packages, you should see a message which will help you find the correct links to download what you need!\n\nWindows will need RTools. First do the check above to see if you are already set up. If not then [download the software here](https://cran.r-project.org/bin/windows/Rtools/).\n\nand Install. After that, open R and run the following:\n\n``` r\nwriteLines('PATH=\"${RTOOLS40_HOME}\\\\usr\\\\bin;${PATH}\"', con = \"~/.Renviron\")\n```\n\nand restart R. Then run the check above once more to confirm\n\n<aside>**During the training I will be calling on learners with different Operating Systems and/or Text Editors to share their experience!**</aside>\n\n## The structure: flour and sugar\n\n> No cookies without carbs\n\nAn R package is essentially a folder on your computer with specific structure. We will begin by creating an empty R package and taking a tour!\n\nOpen your R code editor, and find out where you are:\n\n``` r\ngetwd()\n```\n\nThis is to prepare for the next step, where we will choose a location for our R package folder. Please be intentional about where you place your R package! Do not place it in the same space as another package, Rstudio project or other project. Create a new and isolated location for it.\n\nI am working from an existing R project in my typical R Projects folder, so I go up one level:\n\n``` r\nusethis::create_package(\"../netwerk\")\n```\n\n<aside>we are sticking with `usethis` because we want to keep this general. All of these steps can be manual, and indeed for many years they were!</aside>\n\n![](start_pkg.png)\n\nLet's run R CMD CHECK right away. We will do this MANY TIMES.\n\n``` r\ndevtools::check()\n```\n\nWe should see some warnings! let's keep these in mind as we continue our tour.\n\n### The DESCRIPTION file\n\nThe most important file to notice is the DESCRIPTION. This gives general information about the entire package. It is written in a specific file format\n\n``` dcf\nPackage: netwerk\nTitle: Werks with Networks\nVersion: 0.0.0.9000\nAuthors@R: \n    person(given = \"Andrew\",\n           family = \"MacDonald\",\n           role = c(\"aut\", \"cre\"),\n           email = \"<you@email.com>\")\nDescription: it does networks.\nLicense: MIT + file LICENSE\nEncoding: UTF-8\nLazyData: true\nRoxygen: list(markdown = TRUE)\nRoxygenNote: 7.1.1\nSuggests: \n    testthat (>= 3.0.0)\nConfig/testthat/edition: 3\n```\n\nHere are some things to edit *manually* in `DESCRIPTION`:\n\n-   package name \\[tk naming of R packages\\] -- make it short and convenient if you can!\n-   Title: write this part In Title Case. Don't end the title with a period.\n-   Description: Describe the package in a short block of text. This *should* end with a period.\n-   Authors: Add your name here and the name of anyone building the package with you. `usethis` will have done the first step for you, and filled in the structure. Only \"aut\" (author) and \"cre\" (creator) are essential. [but many others are possible](https://www.loc.gov/marc/relators/relaterm.html)\n\nAdd your name here.\n\nAdd a license\n\n``` r\nusethis::use_mit_license(copyright_holder = \"\")\n```\n\nnote about the different roles that R package authors can have. Funny ones. but creator and maintainer are the key ones.\n\nNote the R folder. We'll get much more into that later\n\n-   Rbuildignore\n\n## Keeping notes\n\ncreate an R file\n\n``` r\nusethis::use_build_ignore(\"dev.R\")\n```\n\nthe docs folder\n\nhere we have a very minimal version of an R packages we're going to be adding to it as the course progresses.\n\nOne thing we can do right away is build and check the R package\n\nWhat exactly is happining here? slide from R package tutorial.\n\nLots of checkpoints and progress confrimations along the way.\n\nOK so what is that all about? we have compiled the R package and it has gone to where the R packages on our computer go.\n\nThere is a natural cycle to how the different steps in an R package workflow proceed -- see the documentation for this lesson -- we will be following this process (TK another pictures?\n\nOk so now that we ahve the basic structure, let's talk about some content for the R package. I received the donation of a little R function already that we can use to create this workflow in a nice way\n\nThis R function (explain what the function does)\n\nOK so let's focus on just one part of this function.\n\nload all -- shortcut\n\n> how do we do this in VScode?\n\n> how to add something to the .Rbuildignore? it would be nice to have a little .dev script as a space to create all the ohter dependencies that are involved in making an R package.\n\n```{r, message=FALSE}\nusethis::use_build_ignore(\"development.R\")\n```\n\n## Useful links\n\nThis workshop borrows heavily from some excellent sources:\n\n-   the [R packages book](https://r-pkgs.org/index.html) especially the [\"Whole Game\"](https://r-pkgs.org/whole-game.html#whole-game) chapter!\n-   [rOpenSci Packages: Development, Maintenance, and Peer Review](https://devguide.ropensci.org/index.html)\n\nhttps://builder.r-hub.io/about.html\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = FALSE, message = FALSE)\n```\n\n<iframe src=\"https://giphy.com/embed/HGe4zsOVo7Jvy\" width=\"480\" height=\"270\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen>\n\n</iframe>\n\n<p><a href=\"https://giphy.com/gifs/sesame-street-cookies-cookie-monster-HGe4zsOVo7Jvy\">via GIPHY</a></p>\n\nR packages! they are kind of like cookies:\n\n-   Almost everyone enjoys them\n\n-   delicious when homemade\n\n-   Lots of storebought options available\n\n-   Great skill to have\n\n-   not necessary to sell them!\n\n    <aside>here \"selling\" cookies is a metaphor for taking your package public, i.e. by submitting to CRAN or even simply by releasing it on a public-facing GitHub page.</aside>\n\nBut most of all: cookies are delicious for what they *contain*: chocolate chunks, candy, oats, cocoa. However, all cookies share some fundamental ingredients and nearly identical structure. Flour, saturated with fat and sugar hydrated only with an egg, flavoured with vanilla and salt. The basic formula is invariant and admits only slight deviation -- otherwise, it becomes something other than a cookie.\n\nThis workshop is devoted to the study of cookie dough.\n\n### *Mise en place* : development environment\n\nWe'll explore a few useful packages in this workshop. The first two in particular are very popular tools for modern-day R package development:\n\n``` r\ninstall.packages(\"devtools\")\ninstall.packages(\"usethis\")\ninstall.packages(\"testthat\")\ninstall.packages(\"assertthat\")\n```\n\nBuilding an R package also requires specific tools for compiling the finished package. Run the following line to make sure you have the development environment:\n\n``` r\ndevtools::has_devel()\n```\n\nIf you do not have the software to build R packages, you should see a message which will help you find the correct links to download what you need!\n\nWindows will need RTools. First do the check above to see if you are already set up. If not then [download the software here](https://cran.r-project.org/bin/windows/Rtools/).\n\nand Install. After that, open R and run the following:\n\n``` r\nwriteLines('PATH=\"${RTOOLS40_HOME}\\\\usr\\\\bin;${PATH}\"', con = \"~/.Renviron\")\n```\n\nand restart R. Then run the check above once more to confirm\n\n<aside>**During the training I will be calling on learners with different Operating Systems and/or Text Editors to share their experience!**</aside>\n\n## The structure: flour and sugar\n\n> No cookies without carbs\n\nAn R package is essentially a folder on your computer with specific structure. We will begin by creating an empty R package and taking a tour!\n\nOpen your R code editor, and find out where you are:\n\n``` r\ngetwd()\n```\n\nThis is to prepare for the next step, where we will choose a location for our R package folder. Please be intentional about where you place your R package! Do not place it in the same space as another package, Rstudio project or other project. Create a new and isolated location for it.\n\nI am working from an existing R project in my typical R Projects folder, so I go up one level:\n\n``` r\nusethis::create_package(\"../netwerk\")\n```\n\n<aside>we are sticking with `usethis` because we want to keep this general. All of these steps can be manual, and indeed for many years they were!</aside>\n\n![](start_pkg.png)\n\nLet's run R CMD CHECK right away. We will do this MANY TIMES.\n\n``` r\ndevtools::check()\n```\n\nWe should see some warnings! let's keep these in mind as we continue our tour.\n\n### The DESCRIPTION file\n\nThe most important file to notice is the DESCRIPTION. This gives general information about the entire package. It is written in a specific file format\n\n``` dcf\nPackage: netwerk\nTitle: Werks with Networks\nVersion: 0.0.0.9000\nAuthors@R: \n    person(given = \"Andrew\",\n           family = \"MacDonald\",\n           role = c(\"aut\", \"cre\"),\n           email = \"<you@email.com>\")\nDescription: it does networks.\nLicense: MIT + file LICENSE\nEncoding: UTF-8\nLazyData: true\nRoxygen: list(markdown = TRUE)\nRoxygenNote: 7.1.1\nSuggests: \n    testthat (>= 3.0.0)\nConfig/testthat/edition: 3\n```\n\nHere are some things to edit *manually* in `DESCRIPTION`:\n\n-   package name \\[tk naming of R packages\\] -- make it short and convenient if you can!\n-   Title: write this part In Title Case. Don't end the title with a period.\n-   Description: Describe the package in a short block of text. This *should* end with a period.\n-   Authors: Add your name here and the name of anyone building the package with you. `usethis` will have done the first step for you, and filled in the structure. Only \"aut\" (author) and \"cre\" (creator) are essential. [but many others are possible](https://www.loc.gov/marc/relators/relaterm.html)\n\nAdd your name here.\n\nAdd a license\n\n``` r\nusethis::use_mit_license(copyright_holder = \"\")\n```\n\nnote about the different roles that R package authors can have. Funny ones. but creator and maintainer are the key ones.\n\nNote the R folder. We'll get much more into that later\n\n-   Rbuildignore\n\n## Keeping notes\n\ncreate an R file\n\n``` r\nusethis::use_build_ignore(\"dev.R\")\n```\n\nthe docs folder\n\nhere we have a very minimal version of an R packages we're going to be adding to it as the course progresses.\n\nOne thing we can do right away is build and check the R package\n\nWhat exactly is happining here? slide from R package tutorial.\n\nLots of checkpoints and progress confrimations along the way.\n\nOK so what is that all about? we have compiled the R package and it has gone to where the R packages on our computer go.\n\nThere is a natural cycle to how the different steps in an R package workflow proceed -- see the documentation for this lesson -- we will be following this process (TK another pictures?\n\nOk so now that we ahve the basic structure, let's talk about some content for the R package. I received the donation of a little R function already that we can use to create this workflow in a nice way\n\nThis R function (explain what the function does)\n\nOK so let's focus on just one part of this function.\n\nload all -- shortcut\n\n> how do we do this in VScode?\n\n> how to add something to the .Rbuildignore? it would be nice to have a little .dev script as a space to create all the ohter dependencies that are involved in making an R package.\n\n```{r, message=FALSE}\nusethis::use_build_ignore(\"development.R\")\n```\n\n## Useful links\n\nThis workshop borrows heavily from some excellent sources:\n\n-   the [R packages book](https://r-pkgs.org/index.html) especially the [\"Whole Game\"](https://r-pkgs.org/whole-game.html#whole-game) chapter!\n-   [rOpenSci Packages: Development, Maintenance, and Peer Review](https://devguide.ropensci.org/index.html)\n\nhttps://builder.r-hub.io/about.html\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"number-sections":true,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","listing":{"sort-ui":["date","author"]},"theme":"flatly","title-block-banner":true,"citation":{"container-title":"BIOS² Education Resources"},"title":"Building R packages","description":"This practical training will cover the basics of modern package development in R with a focus on the following three aspects: (1) how to turn your code into functions, (2) how to write tests and documentation, and (3) how to share your R package on GitHub..\n","author":[{"name":"Andrew MacDonald","affilitation":"Université de Sherbrooke"}],"date":"2021-05-04","image":"altumcode-PNbDkQ2DDgM-unsplash.jpeg","categories":["Technical","EN"],"number-depth":1},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}